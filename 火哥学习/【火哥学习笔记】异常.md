## 准备

**异常进入R0的时候，ESP指向 _KTRAP_FRAME 的+0x64（ErrCode）位置**

![](\picture\)

## 异常分类

### 错误类

比如**除0**错误，此时记录的异常地址为异常指令的地址

```asm
mov ecx,0
div ecx                 //  << 异常地址指向这里
mov edx,ecx 
```

### 陷阱类

比如`int3`异常，此时记录的异常地址为异常指令的下一条指令

```asm
xor eax,eax
int 3
xor eax,eax             // << 异常地址指向这里
```

### 中止类

直接蓝屏了 ，没有更多的操作空间。

## CPU异常记录

